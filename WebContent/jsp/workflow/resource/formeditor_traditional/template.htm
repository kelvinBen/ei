<HTML>
<HEAD>
<TITLE>模板属性　　　　　　　　　　　　　　　　　　　　　　　　　　　　　</TITLE>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<style>
td,legend{font-size:9pt;line-height:28px}
</style>
<script>
function IsDigit()
{
  return ((event.keyCode >= 48) && (event.keyCode <= 57));
}
function WBTB_selColor(obj)
{
	var arr = showModalDialog("selcolor.html", "", "dialogWidth:20.5em; dialogHeight:20em; status:0; help:0");
	if (arr != null && arr != ""){
	 obj.value=arr;
	 document.all(obj.id+"_img").style.background=arr;
	 }
}

</script>
</HEAD>
<script language="javascript">
var win,tabAll,xmlTabCol,xmlTabRow;
function init()
{
win=window.dialogArguments;
tabAll=win.ff.OBJ.getTabAll();

var wid=tabAll.width;
var border=tabAll.style.borderWidth;
var lbordercolor=tabAll.style.borderLeftColor;
var rbordercolor=tabAll.style.borderRightColor;
var tbordercolor=tabAll.style.borderTopColor;
var bbordercolor=tabAll.style.borderBottomColor;
var tdbordercolor=tabAll.getAttribute("tdbordercolor");

var bgcolor=tabAll.bgColor;
var align=tabAll.align;
var table_w=document.all("table_w");
var tdstr="";
if(wid!=null && wid!="")
{
	if(wid.indexOf("%")<0)
	{
	var index1=wid.indexOf("px");
	if(index1<0) index1=wid.length;
	var onlywid=wid.substring(0,index1);
	table_w.value=onlywid;
	var width_type=document.all("width_type");
	width_type.options[1].selected=true;
	}
	else
	{
	table_w.value=wid.substring(0,wid.indexOf("%"));
	}
}
if(align!=null && align!="")
selectedByvalue("align",align);
if(border!=null && border!="")
{
	document.all("border_w").value=parseFloat(border);
}
if(lbordercolor!=null && lbordercolor!="")
{
	document.all("lbdcolor").value=lbordercolor;
	document.all("lbdcolor_img").style.backgroundColor=lbordercolor;
}
if(rbordercolor!=null && rbordercolor!="")
{
	document.all("rbdcolor").value=rbordercolor;
	document.all("rbdcolor_img").style.backgroundColor=rbordercolor;
}
if(tbordercolor!=null && tbordercolor!="")
{
	document.all("tbdcolor").value=tbordercolor;
	document.all("tbdcolor_img").style.backgroundColor=tbordercolor;
}
if(bbordercolor!=null && bbordercolor!="")
{
	document.all("bbdcolor").value=bbordercolor;
	document.all("bbdcolor_img").style.backgroundColor=bbordercolor;
}

if(bgcolor!=null && bgcolor!="")
{
	document.all("bgcolor").value=bgcolor;
	document.all("bgcolor_img").style.backgroundColor=bgcolor;
}
if(tdbordercolor!=null && tdbordercolor!="")
{
	document.all("tdbordercolor").value=tdbordercolor;
	document.all("tdbordercolor_img").style.backgroundColor=tdbordercolor;
}


}
//根据ID,value使下拉框选中
function selectedByvalue(name,value)
{
var sel=document.all(name);
if(sel!=null && sel.tagName!="SELECT") return;
	for(var i=0;i<sel.options.length;i++)
	{
	var opt=sel.options[i];
		if(opt.value==value)
		{
		opt.selected=true;
		return;
		}
	}
}
function dosave()
{
var table_w=document.all("table_w");
if(table_w.value==null && table_w.value=="")
{
alert("表格宽度不能为空！");
table_w.focus();
return;
}
var tabWid=table_w.value;
var width_type=document.all("width_type");
if(width_type.options[width_type.selectedIndex].value==1)
{
tabWid=tabWid+"%";
}
else
	tabWid=tabWid+"px";

var tabalign=document.all("align");
var aligntxt=tabalign.options[tabalign.selectedIndex].value;
/*
var cellpadding=document.all("cellpadding");
var cellpaddingstr=0;

if(isNaN(cellpadding.value))
{
alert("单元格边距必须为数字！");
cellpadding.focus();
return;
}
if(cellpadding.value!="")
{
cellpaddingstr=cellpadding.value;
}
var cellspacing=document.all("cellspacing");
var cellspacingstr=0;
if(isNaN(cellspacing.value))
{
alert("单元格间距必须为数字！");
cellspacing.focus();
return;
}

if(cellspacing.value!="")
{
cellspacingstr=cellspacing.value;
}
*/
var lbdcolor=document.all("lbdcolor");
var lbdcolortxt="";
if(lbdcolor.value!="")
{
lbdcolortxt=lbdcolor.value;
}
var rbdcolor=document.all("rbdcolor");
var rbdcolortxt="";
if(rbdcolor.value!="")
{
rbdcolortxt=rbdcolor.value;
}
var tbdcolor=document.all("tbdcolor");
var tbdcolortxt="";
if(tbdcolor.value!="")
{
tbdcolortxt=tbdcolor.value;
}
var bbdcolor=document.all("bbdcolor");
var bbdcolortxt="";
if(bbdcolor.value!="")
{
bbdcolortxt=bbdcolor.value;
}


var bgcolor=document.all("bgcolor");
var bgcolortxt="";
if(bgcolor.value!="")
{
bgcolortxt=bgcolor.value;
}

var tdbordercolor=document.all("tdbordercolor");
var tdbordercolortxt="";
if(tdbordercolor.value!="")
{
tdbordercolortxt=tdbordercolor.value;
}

var border_w=document.all("border_w");
if(isNaN(border_w.value))
{
alert("边框宽度必须为数字！");
border_w.focus();
return;
}

var borderWid=0;
if(border_w.value!="")
{
borderWid=border_w.value;
}

tabAll.width=tabWid;
	tabAll.style.borderLeft=borderWid+" solid "+lbdcolortxt;
	tabAll.style.borderRight=borderWid+" solid "+rbdcolortxt;
	tabAll.style.borderTop=borderWid+" solid "+tbdcolortxt;
	tabAll.style.borderBottom=borderWid+" solid "+bbdcolortxt;
	tabAll.align=aligntxt;
	tabAll.bgColor=bgcolortxt;
	tabAll.tdbordercolor=tdbordercolortxt;
	tabAll.borderwidth=border_w.value;
	//遍历所有td
	for(var jj=0;jj<tabAll.rows.length;jj++)
		for(var kk=0;kk<tabAll.rows[jj].cells.length;kk++)
		{
		var otd=tabAll.rows[jj].cells[kk];
		if(otd!=null)
		otd.style.borderColor=tdbordercolortxt;
		}
window.close();

}
function docancel()
{
window.close();
}
//disabled所有图片，树
function DisabledAll()
{
var imgs=win.document.images;
		for(var i=0;i<imgs.length;i++)
		{
		imgs[i].disabled=true;
		}
var tabpwin=win.document.all("05");
tabpwin.disabled=false;
var tree=win.document.all("treetd");
tree.style.visibility="hidden";
}
//恢复disabled所有图片，树
function UnDisabledAll()
{
var imgs=win.document.images;
		for(var i=0;i<imgs.length;i++)
		{
		imgs[i].disabled=false;
		}
var tree=win.document.all("treetd");
tree.style.visibility="";
}

//增加列宽的文本框
function addCols()
{
var cols=event.srcElement.value;
var otd=document.all("cells");
if(isNaN(cols))
	{
	alert("列数必须是数字");
	return;
	}
if(parseInt(cols)<1)
{
alert("列数不能小于1");
return;
}
var str="";
for(var i=0;i<parseInt(cols);i++)
{
if(i%3==0 && i!=0)
str+="<br>";
str+="<input name='cellwid' size=3>";
}
otd.innerHTML=str;
}
</script>

<BODY bgcolor=buttonface onload="init()">

	<fieldset  class="radiogroup" style="padding:10;margin-left:12;margin-bottom:4"><legend>表格</legend>
	<table border="0" cellpadding="0" cellspacing="0" width="400">
  <tr>
    <td width="25%">表格宽度:</td>
    <td width="75%" colspan="3"><input type="text" name="table_w" value="600" size="6">
    <select name="width_type" size="1"> 
  <option value="1" >百分比</option>
  <option value="2" selected>像素</option>
</select></td>
  </tr>
  <tr>
    <td width="25%">对齐方式:</td>
    <td width="25%"><select name="align" size="1">
  <option selected>默认</option>
  <option value="center">水平居中</option>
  <option value="left">左对齐</option>
  <option value="right">右对齐</option>
  <option value="justify">两端对齐</option>
</select></td>
    <!--
  <td width="25%" align="center">单元格边距:</td>
    <td width="25%"><input type="text" name="cellpadding" value="0" size="6"></td>
  </tr>
  <tr>
    <td width="25%">单元格间距:</td>
    <td width="25%"><input type="text" name="cellspacing" value="0" size="6"></td>  -->
    <td width="25%" >边框宽度:</td>
    <td width="25%"><input type="text" name="border_w" value="1" size="6"></td>
  </tr>

  <tr>
    <td width="25%">左边框颜色:</td>
    <td width="25%"><INPUT TYPE=TEXT SIZE=7 ID=lbdcolor value="#000000"><span style="background:#000000" id="lbdcolor_img"><img border="0" src="Rect.gif" width="18" height="17" align="absmiddle" onclick="WBTB_selColor(lbdcolor);"></span></td>
	 <td width="25%">右边框颜色:</td>
    <td width="25%"><INPUT TYPE=TEXT SIZE=7 ID=rbdcolor value="#000000"><span style="background:#000000" id="rbdcolor_img"><img border="0" src="Rect.gif" width="18" height="17" align="absmiddle" onclick="WBTB_selColor(rbdcolor);"></span></td>
</tr>
 <tr>
    <td width="25%">上边框颜色:</td>
    <td width="25%"><INPUT TYPE=TEXT SIZE=7 ID=tbdcolor value="#000000"><span style="background:#000000" id="tbdcolor_img"><img border="0" src="Rect.gif" width="18" height="17" align="absmiddle" onclick="WBTB_selColor(tbdcolor);"></span></td>
	 <td width="25%">下边框颜色:</td>
    <td width="25%"><INPUT TYPE=TEXT SIZE=7 ID=bbdcolor value="#000000"><span style="background:#000000" id="bbdcolor_img"><img border="0" src="Rect.gif" width="18" height="17" align="absmiddle" onclick="WBTB_selColor(bbdcolor);"></span></td>
</tr>
	<tr>
    <td width="25%" >背景颜色:</td>
    <td width="25%"><INPUT TYPE=TEXT SIZE=7 ID=bgcolor value="#ffffff"><span style="background:#ffffff" id="bgcolor_img"><img border="0" src="Rect.gif" width="18" height="17" align="absmiddle" onclick="WBTB_selColor(bgcolor);"></span></td>
	  <td width="25%" align="center">单元格边框颜色:</td>
    <td width="25%"><INPUT TYPE=TEXT SIZE=7 ID=tdbordercolor value="#000000"><span style="background:#000000" id="tdbordercolor_img"><img border="0" src="Rect.gif" width="18" height="17" align="absmiddle" onclick="WBTB_selColor(tdbordercolor);"></span></td>
  </tr>
   

</table>
</fieldset>   
<div align="center" width="50">
<BUTTON ID=Ok TYPE=SUBMIT onclick="dosave();">确定</BUTTON>&nbsp; &nbsp; <BUTTON ONCLICK="docancel();">取消</BUTTON></div>     
</BODY>   
</HTML>