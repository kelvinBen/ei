<HTML>
<HEAD>
<title>颜色</title>
<script language="JavaScript">
	var todiv = null;
	var cur=null;
	var curCol=window.dialogArguments;
	function document.onselectstart(){
		var obj=event.srcElement ;
		if(obj.tagName!="INPUT")
			return false;
	}
	function document.onmousedown(){
		var obj=event.srcElement;
		var pobj=obj.parentElement.id;
		if(obj.className=="span"){
			for(i=1;i<=2;i++){
				if(pobj==("btn"+i)){
					document.all("td"+i).style.backgroundColor="#d4d0c8";
					document.all("btn"+i).style.height=20;
					content(i);
				}
				else{
					document.all("td"+i).style.backgroundColor="white";
					document.all("btn"+i).style.height=18;
              }
			}
		} 
	}
	function content(i){
		mnuItem(1,"标准");
		mnuItem(2,"自定义");
		if(todiv!=null)
			todiv.style.display ="none";
		eval("tab"+i+".style.display='';");
		eval("todiv=tab"+i+";");
	}
	function mnuItem(i,con){
		document.all("MenuName"+i).innerText=con;
	}
	function colorCell(cval,ctit){
		this.cval=cval;
		this.ctit=ctit;
	}
	var rows=new Array(5);
	rows[0]=new Array(new colorCell("#000000","黑色"),new colorCell("#802a2a","褐色"),new colorCell("#808000","橄榄绿"),new colorCell("#385e0f","深绿"),new colorCell("#082e54","深青"),new colorCell("#191970","深蓝"),new colorCell("#3d59ab","靛蓝"),new colorCell("#292421","灰色-80%"));
	rows[1]=new Array(new colorCell("#b22222","深红"),new colorCell("#ff6100","橙色"),new colorCell("#6b8e23","深黄"),new colorCell("#228b22","绿色"),new colorCell("#03a89e","青色"),new colorCell("#0000ff","蓝色"),new colorCell("#3d59ab","蓝-灰"),new colorCell("#808a87","灰色-50%"));
	rows[2]=new Array(new colorCell("#ff0000","红色"),new colorCell("#ff8000","浅橙色"),new colorCell("#32cd32","酸橙色"),new colorCell("#2e8b57","海绿"),new colorCell("#40e0d0","水绿色"),new colorCell("#1e90ff","浅蓝"),new colorCell("#8a2be2","紫罗兰"),new colorCell("#c0c0c0","灰色-40%"));
	rows[3]=new Array(new colorCell("#ffc0cb","粉红"),new colorCell("#ffd700","金色"),new colorCell("#ffff00","黄色"),new colorCell("#00ff00","鲜绿"),new colorCell("#00ffff","青绿"),new colorCell("#87ceeb","天蓝"),new colorCell("#872657","梅红"),new colorCell("#dcdcdc","灰色-25%"));
	rows[4]=new Array(new colorCell("#bc8f8f","玫瑰红"),new colorCell("#ffdead","茶色"),new colorCell("#ffffcd","浅黄"),new colorCell("#7fffd4","浅绿"),new colorCell("#bdfcc9","浅青绿"),new colorCell("#b0e0e6","淡蓝"),new colorCell("#da70d6","淡紫"),new colorCell("#ffffff","白色"));
	var SelRGB = '#000000';
	var DrRGB = '';
	var SelGRAY = '120';
	var hexch = new Array('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f');
	function ToHex(n){
		var h, l;
		n = Math.round(n);
		l = n % 16;
		h = Math.floor((n / 16)) % 16;
		return (hexch[h] + hexch[l]);
	}
	function DoColor(c, l){ 
		var r, g, b;
		r = '0x' + c.substring(1, 3);
		g = '0x' + c.substring(3, 5);
		b = '0x' + c.substring(5, 7);
		if(l > 120){
			l = l - 120;
			r = (r * (120 - l) + 255 * l) / 120;
			g = (g * (120 - l) + 255 * l) / 120;
			b = (b * (120 - l) + 255 * l) / 120;
		}else{
			r = (r * l) / 120;
			g = (g * l) / 120;
			b = (b * l) / 120;
		}
		return '#' + ToHex(r) + ToHex(g) + ToHex(b);
	}
	function EndColor(){ 
		var i;
		if(DrRGB != SelRGB){
			DrRGB = SelRGB;
			for(i = 0; i <= 30; i ++)
				GrayTable.rows(i).bgColor = DoColor(SelRGB, 240 - i * 8);
		}
		SelColor.value = DoColor(RGB.innerText, GRAY.innerText);
		ShowColor.rows[0].cells[0].bgColor = SelColor.value;
	}
	function EndColor1(){
		SelColor1.value = DoColor(RGB.innerText, GRAY.innerText);
		ShowColor1.rows[0].cells[0].bgColor = SelColor.value;
	}
</script>
<SCRIPT LANGUAGE=JavaScript FOR=ColorTable EVENT=onclick>
	if(event.srcElement.tagName=="TD"){
		SelRGB = event.srcElement.bgColor;
		EndColor1();
		EndColor();
	}
</SCRIPT>
<SCRIPT LANGUAGE=JavaScript FOR=ColorTable EVENT=onmouseover>
	RGB.innerText = event.srcElement.bgColor.toUpperCase();
	EndColor();
</SCRIPT>
<SCRIPT LANGUAGE=JavaScript FOR=ColorTable EVENT=onmouseout>
	RGB.innerText = SelRGB;
	EndColor();
</SCRIPT>
<SCRIPT LANGUAGE=JavaScript FOR=GrayTable EVENT=onclick>
	SelGRAY = event.srcElement.TITLECOLOR;
	EndColor1();
	EndColor();
</SCRIPT>
<SCRIPT LANGUAGE=JavaScript FOR=GrayTable EVENT=onmouseover>
	GRAY.innerText = event.srcElement.TITLECOLOR;
	EndColor();
</SCRIPT>
<SCRIPT LANGUAGE=JavaScript FOR=GrayTable EVENT=onmouseout>
	GRAY.innerText = SelGRAY;
	EndColor();
</SCRIPT>
<SCRIPT LANGUAGE=JavaScript FOR=Ok EVENT=onclick>
	window.returnValue = SelColor.value;
	window.close();
</SCRIPT>
<style type="text/css">
	td{
		font-size:9pt;
		white-space:nowrap;
	}
	.span{
		cursor:default;
		padding-left:5;
		padding-top:2;
		padding-right:5;
		padding-bottom:0;
		width:100%;
		height:100%;
	}
	.cellf{border:1 solid menu;}
	.cellr{background:lightsteelblue;border:1 solid navy;}
	.cellt{background:menu;border:1 solid menu;}
	.cellc{background:lavender;border:1 solid navy;}
</style>
<META http-equiv="content-type" content="text/html;charset=gb2312">
</HEAD>
<BODY bgcolor=menu onload="content(1)">
	<table width="100%" bgcolor="#d4d0c8" align="center">
	<tr><td>
		<table cellpadding="0" cellspacing="0" width="100%" onselectstart="return false">
		<tr height="20">
			<td valign="bottom" width="30" nowrap>
			<table cellspacing="0"  cellpadding="0" bgcolor="#d4d0c8">
				<tr><td width="1" height="1"></td><td width="1" height="1"></td><td bgcolor="white"></td><td></td><td></td></tr>
				<tr><td width="1" height="1"></td><td width="1" height="1" bgcolor="white"></td><td></td><td bgcolor="black" nowrap></td><td></td></tr>
				<tr><td width="1" bgcolor="white"></td><td width="1" height="1"></td><td id="btn1" height="20" nowrap><span class="span" id="MenuName1" nowrap></span></td><td width="1" bgcolor="gray" nowrap></td><td bgcolor="black" width="1" nowrap></td></tr>
                <tr><td bgcolor="white" nowrap></td><td colspan="4" height="1" bgcolor="#d4d0c8" id="td1" nowrap></td></tr>
			</table></td>
			<td valign="bottom" width="50" nowrap>
			<table cellspacing="0"  cellpadding="0" bgcolor="#d4d0c8">
				<tr><td width="1" height="1"></td><td width="1" height="1"></td><td bgcolor="white"></td><td></td><td></td></tr>
                <tr><td width="1" height="1"></td><td width="1" height="1" bgcolor="white"></td><td></td><td bgcolor="black" nowrap></td><td></td></tr>
				<tr><td width="1" bgcolor="white"></td><td width="1" height="1"></td><td id="btn2" height="18" nowrap><span class="span" id="MenuName2" nowrap></span></td><td width="1" bgcolor="gray" nowrap></td><td bgcolor="black" width="1" nowrap></td></tr>
				<tr><td bgcolor="white" nowrap></td><td colspan="4" height="1" bgcolor="white" id="td2" nowrap></td></tr>
			</table></td>
			<td style="border-bottom:1 solid white;width:100%;" height="1">&nbsp;</td>
		</tr></table>
		<div style="padding:10;width:100%;height:200;border-left:1 white solid;border-right:2 outset;border-bottom:2 outset">
			<span id="span1"><div id="tab1" style="width:285;height:222;"><center>
				<table id="colorstable" cellspacing=4 CELLPADDING=0 style="cursor:default;margin-top:30;border:2 groove white;">
					<script language=javascript>
						for(var i=0;i<5;i++){
							document.write("<tr>");
							for(var j=0;j<8;j++){
								if(rows[i][j].cval!=curCol)
									document.write("<td UNSELECTABLE=true style='width:22;height:24;' class='cellf' ALIGN=center><span style='width:18;height:18;border:1 solid background;background:"+rows[i][j].cval+";' title="+rows[i][j].ctit+" onmouseover='domover(this);'  onmouseout='domout(this);' onmousedown='domdown(this);'></span></td>");
								else
									document.write("<td UNSELECTABLE=true style='width:22;height:24;' class='cellc' ALIGN=center><span style='width:18;height:18;border:1 solid background;background:"+rows[i][j].cval+";' title="+rows[i][j].ctit+" onmouseover='domover(this);'  onmouseout='domout(this);' onmousedown='domdown(this);'></span></td>");
							}
							document.write("</tr>");
						}
						var allCel=document.all("colorstable").cells;
						for(var k=0;k<allCel.length;k++)
						if(allCel(k).className=="cellc"){
							cur=allCel(k).children[0];
							break;
						}
					</script>
				</table>        
		</center></div>
		<div id="tab2" style="display:none;">
			<div align="center"><center>
		<table border="0" cellspacing="10" cellpadding="0"><tr><td>
			<TABLE ID=ColorTable BORDER=0 CELLSPACING=0 CELLPADDING=0 style='cursor:hand'>
				<SCRIPT LANGUAGE=JavaScript>
					function wc(r, g, b, n){
						r = ((r * 16 + r) * 3 * (15 - n) + 0x80 * n) / 15;
						g = ((g * 16 + g) * 3 * (15 - n) + 0x80 * n) / 15;
						b = ((b * 16 + b) * 3 * (15 - n) + 0x80 * n) / 15;
						document.write('<TD BGCOLOR=#' + ToHex(r) + ToHex(g) + ToHex(b) + ' height=8 width=8></TD>');
					}
					var cnum = new Array(
						1, 0, 0,
						1, 1, 0, 
						0, 1, 0,
						0, 1, 1,
						0, 0, 1,
						1, 0, 1,
						1, 0, 0);
					for(i = 0; i < 16; i ++){
     					document.write('<TR>');
     					for(j = 0; j < 30; j ++){
     						n1 = j % 5;
     						n2 = Math.floor(j / 5) * 3;
     						n3 = n2 + 3;
     						wc((cnum[n3] * n1 + cnum[n2] * (5 - n1)),
     							(cnum[n3 + 1] * n1 + cnum[n2 + 1] * (5 - n1)),
     							(cnum[n3 + 2] * n1 + cnum[n2 + 2] * (5 - n1)), i);
    					}
     					document.writeln('</TR>');
  					}
				</SCRIPT>
			</TABLE>
			</td>
			<td><TABLE ID=GrayTable BORDER=0 CELLSPACING=0 CELLPADDING=0 style='cursor:hand'>
				<SCRIPT LANGUAGE=JavaScript>
  					for(i = 255; i >= 0; i -= 8.5)
     					document.write('<TR BGCOLOR=#' + ToHex(i) + ToHex(i) + ToHex(i) + '><TD TITLECOLOR=' + Math.floor(i * 16 / 17) + ' height=4 width=20></TD></TR>');
				</SCRIPT>
				</TABLE>
			</td>
		</tr></table>
	</center></div>
	<div align="center"><center>
		<table border="0" cellspacing="10" cellpadding="0" width="100%"><tr>
			<td rowspan="2" align="center" width=70>
				<table ID=ShowColor border="0" width="50" height="40" cellspacing="0" cellpadding="0">
				<tr><td  bgcolor="#000000">&nbsp;</td></tr>
				<tr><td> <SPAN style="display:none" ID=RGB></span><SPAN style="display:none"  ID=GRAY>120</span>
				Code : <INPUT TYPE=TEXT SIZE=7 ID=SelColor value="#000000"></td></tr>
				</table>
			</td>
			<td rowspan="2">
				<table ID=ShowColor1 border="0" width="50" height="40" cellspacing="0" cellpadding="0">
				<tr><td  bgcolor="#000000">&nbsp;</td></tr>
				<tr><td>Code : <INPUT TYPE=TEXT SIZE=7 ID=SelColor1 value="#000000"></td></tr>
				</table>
			</td>
			<td width=50><BUTTON ID=Ok TYPE=SUBMIT>确定</BUTTON></td></tr>
			<tr><td width=50><BUTTON ONCLICK="window.close();">取消</BUTTON></td></tr>
		</table>
		</center></div>
	</div></span>
	</div>
	</td></tr></table>
	<script language=javascript>
		function domdown(obj){
			if(cur!=null)
				cur.parentElement.className="cellt";
			cur=obj;
			obj.parentElement.className="cellc";
			window.returnValue=cur.style.backgroundColor;
			window.close();
		}
		function domover(obj){
			obj.parentElement.className="cellr";
		}
		function domout(obj){
			if(obj!=cur)
				obj.parentElement.className="cellt";
			else
				obj.parentElement.className="cellc";
		}
	</script>
</BODY>
</HTML>

 
