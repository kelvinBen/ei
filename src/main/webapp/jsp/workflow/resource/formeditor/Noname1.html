<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE> New Document </TITLE>
<META NAME="Generator" CONTENT="EditPlus">
<META NAME="Author" CONTENT="">
<META NAME="Keywords" CONTENT="">
<META NAME="Description" CONTENT="">
</HEAD>
<style>
td
{
height:20px;
}
</style>
<BODY onmousedown="dd()" onmousemove="mm()"  onmouseup="pp()"  CONTENTEDITABLE="true">
<TABLE  border=1   id=tt cellspacing=0 cellpadding=3 style="border-collapse:collapse;border-style:dotted;table-layout:fixed">
<colgroup>
<col width="200">
<col width="200">
<col width="200">
</colgroup>
<TR>
	<TD ></TD>
	<TD><input></TD>
	<TD></TD>
</TR>
<TR>
	<TD colspan=2></TD>
	<TD><TABLE  border=1  id=tt2 cellspacing=0 style="border-collapse:collapse;border-style:dotted;table-layout:fixed">
<colgroup>
<col width="20">
<col width="20">
<col width="20">
</colgroup>
<TR>
	<TD></TD>
	<TD></TD>
	<TD></TD>
</TR>
<TR>
	<TD></TD>
	<TD></TD>
	<TD></TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
<button onclick="tt.width=parseInt(tt.width)+64;alert(tt.width);">aa</button>
<div  unselectable=on  style="width:400;height:300;background-color:#CC99CC;" >asd
<span style="border:1 solid" title="调整列" onmouseover="showhr();" onmouseout="hidhr();">ss</span>
</div>
<span style="cursor:url('SizeAll.ani');border:1 solid" title="调整列">ss</span>
<img  unselectable=on  src="del.gif" id="cursorgif" style="position:absolute">
<hr id="hr"  unselectable=on  style="width:2px;background-color:red;height:200px;position:absolute;display:none">
<script>
function showhr()
{
var hr=document.all("hr");
hr.style.display="block";
hr.style.top=event.clientY;
hr.style.left=event.clientX;

}
function hidhr()
{
var hr=document.all("hr");
hr.style.display="none";

}
var currentTd,oldtop,oldleft,isresizeheightdown,oldtdtop,oldtdleft,istdzydown;
function dd()
{
oldtop=event.clientY;
oldleft=event.x;
oldtdtop=event.clientY;
oldtdleft=event.x;

var otd=event.srcElement;
if(otd!=null && otd.tagName=="TD")
{	otd.setCapture();
	var otdleft=otd.offsetLeft+otd.offsetParent.offsetLeft+otd.offsetWidth;
	var otdtop=otd.offsetTop+otd.offsetParent.offsetTop+otd.offsetHeight;
	if(otd.style.cursor=="e-resize")
	{
	istdzydown=true;
	currentTd=otd;
	}
	if(otd.style.cursor=="s-resize")
	{
	isresizeheightdown=true;
	currentTd=otd;
	}
return;
}
}
function mm()
{
//alert(event.clientX+","+event.clientY+","+event.x+","+event.y);
var otd=event.srcElement;
if(otd!=null && otd.tagName=="TD")
{//alert(otd.offsetParent.offsetLeft+","+otd.offsetLeft+","+event.x+","+otd.offsetWidth);

var cc="";
		x=window.getRealLeft(otd);
		y=window.getRealTop(otd);
		w=parseInt(otd.offsetWidth);
		h=parseInt(otd.offsetHeight);
		//if(event.clientY-y<5)cc+="n";
		if(y+h-event.clientY<2)cc="s";
		//if(event.clientX-x<5)cc+="w";
		if(x+w-event.clientX<2)cc="e";
		var cursorimg=document.all("cursorgif");
		if(cc!=""){
			otd.style.cursor=cc+"-resize";
			cursorimg.style.top=event.clientY-otd.clientHeight;
			cursorimg.style.left=event.clientX-cursorimg.clientWidth/2;
			//alert(cc);
			return(true);
			}
		else
			otd.style.cursor="default";

}

}
function pp()
{
//alert(event.srcElement.tagName);
if(isresizeheightdown)
{
var hid=parseInt(currentTd.offsetHeight)-parseInt(oldtop-event.clientY);
if(hid<1)
hid=1;
currentTd.style.height=hid;
isresizeheightdown=false;
currentTd.releaseCapture();
return;
}
if(istdzydown)
{
var ocell=currentTd.cellIndex;
var colgroup=currentTd.offsetParent.children[0].children[ocell];
var newwid=parseInt(colgroup.width)-parseInt(oldtdleft-event.clientX);
if(newwid<1)
newwid=1;
colgroup.width=newwid;
istdzydown=false;
currentTd.releaseCapture();

}

}
//**通用函数区***
function getRealLeft(o){
	var l=o.offsetLeft-o.scrollLeft;
	while(o=o.offsetParent){
		l+=o.offsetLeft-o.scrollLeft;
	}
	return(l);
}

function getRealTop(o){
	var t=o.offsetTop-o.scrollTop;
	while(o=o.offsetParent){
		t+=o.offsetTop-o.scrollTop;
	}
	return(t);
}

</script>
</BODY>
</HTML>
