<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>New Page 1</title>
<link rel="stylesheet" type="text/css" href="conf/XMLSelTree.css">
<SCRIPT LANGUAGE="JavaScript" src="conf/XMLSelTree.js"></script>
<style>
.model{border:1 dashed gray;border-collapse:collapse;}
.model td{border:1 dashed gray;vertical-align:top;padding:2}
.buttonline td{
	border:1 outset;
	font-size:9pt;
	padding:3 5 2 5;
	}
.board{
	border-collapse:collapse;
	border:1 solid black;
	}
.board td{
	background: powderblue;
	vertical-align:middle;
	border:0px;
	}
#title{
	background: background;
	color:white;
	text-align:center;
	cursor:move;
	}
</style>
</head>

<body topmargin="0" leftmargin="0" bgcolor="#FFFFFF" style="overflow:hidden">

<table cellpadding="0" cellspacing="0" width="100%">
  <tr>
    <td width="100%" colspan="2" style="height:20;background: activecaption;
	filter:Alpha(Opacity=100,FinishOpacity=30, Style=1, StartX=0, StartY=0, FinishX=100, FinishY=0);color:white;font-size:10pt;font-weight:bold"><img src="icon.gif">&nbsp;模板定制工具</td>
  </tr>
  <tr>
    <td height="20" colspan="2" style="height:20;background:buttonface;border-bottom:2px solid dimgray;border-top:1px solid white;padding:1">
    <table border="0" cellpadding="0" cellspacing="1" class="buttonline">
  <tr>
	<td></td>
    <td><img src="save.gif" title="保存"></td>
    <td><img src="view.gif" title="预览"></td>
    <td><img src="page.gif" title="模板属性"></td>
    <td><img src="merge.gif" title="合并单元格"></td>
    <td><img src="chaifen.gif" title="拆分单元格"></td>
    <td><img src="insertrow.gif" title="增加行"></td>
    <td><img src="deleterow.gif" title="删除行"></td>
	<td><img src="insertcolumn.gif" title="增加列"></td>
    <td><img src="deletecolumn.gif" title="删除列"></td>
	<td><img src="tdproperty.gif" title="单元格属性"></td>
	<td><select style="margin:-1"><option value="20%">20%</option><option value="">50%</option><option value="">75%</option><option value="" selected>100%</option><option value="">200%</option></select></td>
  </tr>
</table>
    </td>
  </tr>
</table>
<table cellspacing=0 cellpadding=0 >
  <tr>
    <td style="background:buttonface;padding:2;border-right:1 solid dimgray" width=160>
      <table border="0" cellpadding="0" cellspacing="0" width="160" height="100%">
        <tr>
          <td style="background:background;border:1 solid outset;height:22;color:white" align="center">板块树</td>
        </tr>
        <tr>
          <td width="100%" id="treetd" valign="top" style="border:1 inset;background:buttonface">
          <DIV id="SrcDiv" style="overflow:auto;height:expression(document.body.clientHeight-80);"></DIV>
		</td></tr>
		</table>
	</td>
    <td valign="top">
 <div style="width:expression(document.body.clientWidth-163);height:expression(document.body.clientHeight-51);overflow:scroll">
      <table border="0" cellpadding="0" cellspacing="0" width="3000">
        <tr>
          <td style="border-bottom:1 solid black">
		  
          <OBJECT classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
 codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0"
 WIDTH="100%" HEIGHT="22" id="rule" ALIGN="">
 <PARAM NAME=movie VALUE="rule.swf"> <PARAM NAME=quality VALUE=high> <PARAM NAME=bgcolor VALUE=#F1f1f1> 
</OBJECT>
          </td>
        </tr>
        <tr>
          <td id="edittable"></td>
        </tr>
      </table>
      </div></div>
    </td>
	</tr>
 </table>
    <SCRIPT LANGUAGE=javascript>
<!--
edittable.style.zoom="100%";
new GTree("mm","a.xml","conf/", SrcDiv, false, true);
myxml= new ActiveXObject("Msxml.DOMDocument");
myxml.load("data.xml");
mytable=new ActiveXObject("Msxml.DOMDocument");
//
mytable.loadXML("<a><b>dsfsd</b></a>");
for(i=0;i<myxml.childNodes[1].childNodes[0].childNodes.length;i++){
	if(myxml.childNodes[1].childNodes[0].childNodes[i].baseName=="tr"){
		for(j=0;j<myxml.childNodes[1].childNodes[0].childNodes[i].childNodes.length;j++){
			mytable=new ActiveXObject("Msxml.DOMDocument");
			temp="<table class='board' width='100%' height='"+myxml.childNodes[1].childNodes[0].childNodes[i].childNodes[j].childNodes[0].getAttribute("height")+"'  bgcolor='#cccccc'><tr><td id='title' height='16' width='100%'>"+myxml.childNodes[1].childNodes[0].childNodes[i].childNodes[j].childNodes[0].getAttribute("name")+"</td><td style='background: background;'><img src='a.gif'/><img src='c.gif'/><img src='e.gif'/></td></tr><tr><td align='center' colspan='2'>"+myxml.childNodes[1].childNodes[0].childNodes[i].childNodes[j].childNodes[0].getAttribute("type")+"</td></tr></table>";
			mytable.loadXML(temp);
			myxml.childNodes[1].childNodes[0].childNodes[i].childNodes[j].appendChild(mytable.documentElement);
			

0
		}
	}
}
edittable.style.padding=10;
edittable.innerHTML=myxml.childNodes[1].xml;
//alert(myxml.childNodes[1].childNodes[0].childNodes[0].getAttribute('width'));
window.document.rule.SetVariable("_root.leftmargin",10);
window.document.rule.SetVariable("_root.colwidth","200,200,200,200");
function reset(a){
	var mycol=a.split(",");
	for(i=0;i<myxml.childNodes[1].childNodes[0].childNodes.length;i++){
		if(myxml.childNodes[1].childNodes[0].childNodes[i].baseName=="col"){
			myxml.childNodes[1].childNodes[0].childNodes[i].setAttribute('width',mycol[i])
		}
	}
edittable.innerHTML=myxml.childNodes[1].xml;
	}
//-->
</SCRIPT>
</body></html>